import{aA as fn,aB as G,G as hn,P as rn,aY as un,a6 as dn,a7 as gn}from"./ColorSet-BOh1LuAF.js";import{f as on}from"./Theme-B_KJklAe.js";const ln=Math.abs,y=Math.atan2,B=Math.cos,yn=Math.max,en=Math.min,w=Math.sin,j=Math.sqrt,R=1e-12,k=Math.PI,Q=k/2,mn=2*k;function pn(s){return s>1?0:s<-1?k:Math.acos(s)}function cn(s){return s>=1?Q:s<=-1?-Q:Math.asin(s)}function Rn(s){return s.innerRadius}function xn(s){return s.outerRadius}function An(s){return s.startAngle}function vn(s){return s.endAngle}function Dn(s){return s&&s.padAngle}function Mn(s,o,c,g,f,l,d,e){var x=c-s,r=g-o,n=d-f,v=e-l,t=v*x-n*r;if(!(t*t<R))return t=(n*(o-l)-v*(s-f))/t,[s+t*x,o+t*r]}function L(s,o,c,g,f,l,d){var e=s-c,x=o-g,r=(d?l:-l)/j(e*e+x*x),n=r*x,v=-r*e,t=s+n,u=o+v,m=c+n,p=g+v,X=(t+m)/2,h=(u+p)/2,D=m-t,A=p-u,P=D*D+A*A,I=f-l,N=t*p-m*u,b=(A<0?-1:1)*j(yn(0,I*I*P-N*N)),q=(N*A-D*b)/P,C=(-N*D-A*b)/P,S=(N*A+D*b)/P,M=(-N*D+A*b)/P,T=q-X,i=C-h,a=S-X,$=M-h;return T*T+i*i>a*a+$*$&&(q=S,C=M),{cx:q,cy:C,x01:-n,y01:-v,x11:q*(f/I-1),y11:C*(f/I-1)}}function Tn(){var s=Rn,o=xn,c=G(0),g=null,f=An,l=vn,d=Dn,e=null,x=fn(r);function r(){var n,v,t=+s.apply(this,arguments),u=+o.apply(this,arguments),m=f.apply(this,arguments)-Q,p=l.apply(this,arguments)-Q,X=ln(p-m),h=p>m;if(e||(e=n=x()),u<t&&(v=u,u=t,t=v),!(u>R))e.moveTo(0,0);else if(X>mn-R)e.moveTo(u*B(m),u*w(m)),e.arc(0,0,u,m,p,!h),t>R&&(e.moveTo(t*B(p),t*w(p)),e.arc(0,0,t,p,m,h));else{var D=m,A=p,P=m,I=p,N=X,b=X,q=d.apply(this,arguments)/2,C=q>R&&(g?+g.apply(this,arguments):j(t*t+u*u)),S=en(ln(u-t)/2,+c.apply(this,arguments)),M=S,T=S,i,a;if(C>R){var $=cn(C/t*w(q)),z=cn(C/u*w(q));(N-=$*2)>R?($*=h?1:-1,P+=$,I-=$):(N=0,P=I=(m+p)/2),(b-=z*2)>R?(z*=h?1:-1,D+=z,A-=z):(b=0,D=A=(m+p)/2)}var E=u*B(D),O=u*w(D),F=t*B(I),H=t*w(I);if(S>R){var J=u*B(A),K=u*w(A),U=t*B(P),V=t*w(P),Y;if(X<k)if(Y=Mn(E,O,U,V,J,K,F,H)){var W=E-Y[0],Z=O-Y[1],_=J-Y[0],nn=K-Y[1],sn=1/w(pn((W*_+Z*nn)/(j(W*W+Z*Z)*j(_*_+nn*nn)))/2),an=j(Y[0]*Y[0]+Y[1]*Y[1]);M=en(S,(t-an)/(sn-1)),T=en(S,(u-an)/(sn+1))}else M=T=0}b>R?T>R?(i=L(U,V,E,O,u,T,h),a=L(J,K,F,H,u,T,h),e.moveTo(i.cx+i.x01,i.cy+i.y01),T<S?e.arc(i.cx,i.cy,T,y(i.y01,i.x01),y(a.y01,a.x01),!h):(e.arc(i.cx,i.cy,T,y(i.y01,i.x01),y(i.y11,i.x11),!h),e.arc(0,0,u,y(i.cy+i.y11,i.cx+i.x11),y(a.cy+a.y11,a.cx+a.x11),!h),e.arc(a.cx,a.cy,T,y(a.y11,a.x11),y(a.y01,a.x01),!h))):(e.moveTo(E,O),e.arc(0,0,u,D,A,!h)):e.moveTo(E,O),!(t>R)||!(N>R)?e.lineTo(F,H):M>R?(i=L(F,H,J,K,t,-M,h),a=L(E,O,U,V,t,-M,h),e.lineTo(i.cx+i.x01,i.cy+i.y01),M<S?e.arc(i.cx,i.cy,M,y(i.y01,i.x01),y(a.y01,a.x01),!h):(e.arc(i.cx,i.cy,M,y(i.y01,i.x01),y(i.y11,i.x11),!h),e.arc(0,0,t,y(i.cy+i.y11,i.cx+i.x11),y(a.cy+a.y11,a.cx+a.x11),h),e.arc(a.cx,a.cy,M,y(a.y11,a.x11),y(a.y01,a.x01),!h))):e.arc(0,0,t,I,P,h)}if(e.closePath(),n)return e=null,n+""||null}return r.centroid=function(){var n=(+s.apply(this,arguments)+ +o.apply(this,arguments))/2,v=(+f.apply(this,arguments)+ +l.apply(this,arguments))/2-k/2;return[B(v)*n,w(v)*n]},r.innerRadius=function(n){return arguments.length?(s=typeof n=="function"?n:G(+n),r):s},r.outerRadius=function(n){return arguments.length?(o=typeof n=="function"?n:G(+n),r):o},r.cornerRadius=function(n){return arguments.length?(c=typeof n=="function"?n:G(+n),r):c},r.padRadius=function(n){return arguments.length?(g=n==null?null:typeof n=="function"?n:G(+n),r):g},r.startAngle=function(n){return arguments.length?(f=typeof n=="function"?n:G(+n),r):f},r.endAngle=function(n){return arguments.length?(l=typeof n=="function"?n:G(+n),r):l},r.padAngle=function(n){return arguments.length?(d=typeof n=="function"?n:G(+n),r):d},r.context=function(n){return arguments.length?(e=n??null,r):e},r}class tn extends hn{constructor(){super(...arguments),this.ix=0,this.iy=0,this._generator=Tn()}_getTooltipPoint(){let o=this.get("tooltipX"),c=this.get("tooltipY"),g=0,f=0;on(o)&&(g=o),on(c)&&(f=c);let l=this.get("radius",0),d=this.get("innerRadius",0),e=this.get("dRadius",0),x=this.get("dInnerRadius",0);return l+=e,d+=x,d<0&&(d=l+d),o instanceof rn&&(g=this.ix*(d+(l-d)*o.value)),c instanceof rn&&(f=this.iy*(d+(l-d)*c.value)),this.get("arc")>=360&&d==0&&(g=0,f=0),{x:g,y:f}}_beforeChanged(){super._beforeChanged(),(this.isDirty("radius")||this.isDirty("arc")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("dRadius")||this.isDirty("dInnerRadius")||this.isDirty("cornerRadius")||this.isDirty("shiftRadius"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){let o=this.get("startAngle",0),c=this.get("arc",0);const g=this._generator;c<0&&(o=o+c,c=c*-1),c>.1&&g.cornerRadius(this.get("cornerRadius",0)),g.context(this._display);let f=this.get("radius",0),l=this.get("innerRadius",0),d=this.get("dRadius",0),e=this.get("dInnerRadius",0);f+=d,l+=e,l<0&&(l=f+l),g({innerRadius:l,outerRadius:f,startAngle:(o+90)*un,endAngle:(o+c+90)*un});let x=o+c/2;this.ix=dn(x),this.iy=gn(x);const r=this.get("shiftRadius",0);this.setRaw("dx",this.ix*r),this.setRaw("dy",this.iy*r),this.markDirtyPosition()}}}tn.className="Slice";tn.classNames=hn.classNames.concat([tn.className]);export{tn as S};
